| Technique / Artifact                                       | Command                                                                                                         | Utility Type  | Expected Output (if no compromise)                                                                                                                      | MITRE ATT&CK TTP                         |
|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
| **1. Kernel & Modules**                                    |                                                                                                                 |               |                                                                                                                                                         |                                          |
| List loaded kernel modules                                 | `lsmod`                                                                                                         | Native        | A list of module names, sizes, and usage counts (e.g., `nf_conntrack  16384  1`). No unexpected or malicious module names.                              | T1215 Kernel Modules and Extensions       |
| Check for kernel taint                                      | `cat /proc/sys/kernel/tainted`                                                                                  | Native        | `0` (zero) indicates an untainted kernel. Any non-zero value is unusual in a standard distro.                                                           | T1215 Kernel Modules and Extensions       |
| Compare modules in `/sys` versus `lsmod`                   | <pre>`lsmod \| awk '{print $1}' \| sort`  <br>`ls /sys/module \| sort`</pre>                                      | Native        | Both sorted lists match exactly—no module present in one and missing in the other.                                                                      | T1215 Kernel Modules and Extensions       |
| Detect hidden/malicious modules                            | <pre>`diff -u \ <br>  `lsmod \| tail -n +2 \| awk '{print $1}' \| sort`  <br>  `ls /sys/kernel/tracing/available_filter_functions \| sed -n 's/.*\[\([^]]*\)\].*/\1/p' \| sort \| uniq`</pre> | Native        | No differences—no module names/functions appear in `available_filter_functions` that are not listed by `lsmod`.                                         | T1215 Kernel Modules and Extensions       |
| Check for eBPF / tracing hooks                             | <pre>`cat /sys/kernel/debug/tracing/trace`  <br>`cat /sys/kernel/debug/tracing/enabled_functions`</pre>         | Native        | Only expected kernel events (e.g., scheduling, standard syscalls). No unusual hooks or injected probe names.                                           | T1215 Kernel Modules and Extensions       |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **2. `/proc` & Process Artifacts**                         |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Processes running deleted binaries                          | `ls -alR /proc/*/exe 2>/dev/null \| grep deleted`                                                                | Native        | **No output.** (No “deleted” binaries running; if a rootkit/unlink-after-exec trojan is active, lines like `/proc/1234/exe -> /tmp/.xyz (deleted)` appear.) | T1055 Process Injection                   |
| Memory-only (“memfd”) file descriptors                      | `ls /proc/<PID>/fd 2>/dev/null \| grep memfd`                                                                    | Native        | **No output.** (No unexpected `memfd` file descriptors under system daemons.)                                                                          | T1055 Process Injection                   |
| Deleted mappings in a process’s memory                      | `grep '(deleted)' /proc/<PID>/maps 2>/dev/null`                                                                 | Native        | **No output.** (No deleted shared libraries or executables mapped into running processes.)                                                            | T1055 Process Injection                   |
| Environment-based injection (`LD_PRELOAD`)                   | `strings /proc/<PID>/environ 2>/dev/null \| tr '\0' '\n' \| grep LD_PRELOAD`                                     | Native        | **No output.** (No unexpected `LD_PRELOAD` entries in root/system processes.)                                                                          | T1574.002 Hijack Execution Flow (LD_PRELOAD) |
| Mismatched `cmdline` vs. `comm` (masquerading)              | <pre>`cat /proc/<PID>/cmdline`  <br>`cat /proc/<PID>/comm`</pre>                                                 | Native        | Both show the same executable name/path (e.g., `/usr/sbin/sshd` in both).                                                                               | T1036 Masquerading                       |
| Working directory of daemons/processes                      | `ls -alR /proc/*/cwd 2>/dev/null`                                                                                | Native        | Only valid symlinks pointing to expected directories (e.g., `/proc/1234/cwd -> /usr/sbin`). No `/tmp` or `/dev/shm` paths for system daemons.        | T1036 Masquerading                       |
| Processes running from `/tmp` or `/dev/shm`                 | <pre>`ls -alR /proc/*/cwd 2>/dev/null \| grep '/tmp'`  <br>`ls -alR /proc/*/cwd 2>/dev/null \| grep '/dev'`</pre> | Native        | **No output.** (System daemons or privileged apps should not run from `/tmp` or `/dev/shm`.)                                                           | T1036 Masquerading                       |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **3. Filesystem Integrity & Attributes**                   |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Verify installed RPM files                                   | `rpm -Va \| grep '^..5.'`                                                                                        | Native        | **No output.** (No “5” in the fifth column means no file contents changed. Any output indicates a mismatch.)                                             | T1105 Ingress Tool Transfer               |
| Verify installed DEB files                                   | `debsums -c`                                                                                                     | Native        | **No output.** (All checksums match. Any “FAILED” lines are suspicious.)                                                                                | T1105 Ingress Tool Transfer               |
| Immutable files & directories                                | `lsattr -R / 2>/dev/null \| grep '----i'`                                                                        | Native        | Only system-mandated immutable files (e.g., `/boot/vmlinuz-*`, `/etc/shadow` with immutable bit if configured). No unexpected “i” bits on random files.  | T1562.003 Impair Defenses: Disable or Modify Tools |
| Find SUID/SGID files                                         | `find / -type f \( -perm -04000 -o -perm -02000 \) -exec ls -lg {} \; 2>/dev/null`                                | Native        | Only known SUID/SGID binaries (e.g., `/usr/bin/sudo`, `/bin/ping`). No SUID/SGID files under `/tmp`, home dirs, or other odd locations.                | T1543 Create or Modify System Process      |
| Files/dirs with no valid owner/group                          | `find / \( -nouser -o -nogroup \) -exec ls -lg {} \; 2>/dev/null`                                                 | Native        | **No output.** (All files belong to a valid user/group.)                                                                                                | T1083 File and Directory Discovery        |
| Hidden files / Unexpected `.` directories                     | `find / -type d -name '.*' 2>/dev/null`                                                                           | Native        | Only standard hidden directories (e.g., `/root`, `/var/lib/.cache`). No malicious or random hidden folders under system paths.                         | T1083 File and Directory Discovery        |
| Bind-mount anomalies                                          | <pre>`cat /proc/mounts \| grep proc`  <br>`mount \| grep -vE '(/etc|/proc|/sys|/dev)'`</pre>                      | Native        | Mounts match `/etc/fstab` or known ephemeral mounts (e.g., `tmpfs`). No duplicate “proc” under `/proc` or `/sys`.                                        | T1562.003 Impair Defenses                  |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **4. Network Indicators**                                   |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Listening sockets & owner                                     | `ss -plant 2>/dev/null`                                                                                          | Native        | Only expected services (e.g., `sshd`, `httpd`, `nginx`). No unknown daemons listening on high ports.                                                    | T1049 System Network Configuration Discovery |
| Map open sockets to processes                                 | `lsof -Pn -i 2>/dev/null`                                                                                        | Native        | Only legitimate processes (e.g., `sshd`, `systemd-resolve`). No shell/unknown binary with network connections.                                           | T1049 System Network Configuration Discovery |
| DNS tunneling / Unexpected DNS queries                         | <pre>`tcpdump -i any -n -s0 udp port 53 -c 20`</pre>                                                               | Native        | Only normal DNS queries to known resolvers. No excessive or suspicious domain patterns (e.g., random subdomains).                                        | T1040 Network Sniffing                    |
| iptables rules / NAT anomalies                                 | <pre>`iptables -L -v -n 2>/dev/null`  <br>`iptables -t nat -L -v -n`</pre>                                         | Native        | Only approved firewall rules. No DNAT/SNAT or forwarding rules to unexpected external IPs.                                                               | T1562.003 Impair Defenses                  |
| eBPF / XDP programs                                            | <pre>`ip link show \| grep xdp`  <br>`bpftool prog list 2>/dev/null`  <br>`bpftool map list 2>/dev/null`</pre>    | Native        | XDP columns are empty or show only expected driver programs. `bpftool` lists only known BPF programs (e.g., CNI, perf tracing). No suspicious BPF.      | T1215 Kernel Modules and Extensions       |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **5. User Accounts & Authentication**                       |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Look for UID=0 entries                                         | `grep '^.*:x:0:' /etc/passwd`                                                                                     | Native        | Only the “root” account (and any approved admin with UID=0). No unexpected UID=0 lines.                                                                 | T1087 Account Discovery                    |
| Check SSH `authorized_keys` files                              | `find /home -name authorized_keys 2>/dev/null`                                                                     | Native        | Only home directories of known users have `authorized_keys` files. No unauthorized SSH keys under root or elsewhere.                                      | T1574.002 Hijack Execution Flow (SSH)      |
| Inspect `/etc/sudoers` & `/etc/sudoers.d/`                     | <pre>`cat /etc/sudoers 2>/dev/null`  <br>`ls /etc/sudoers.d/ 2>/dev/null`</pre>                                    | Native        | Only approved sudo rules (e.g., `%wheel ALL=(ALL) ALL`). No lines granting ALL privileges to unknown users.                                               | T1574.002 Hijack Execution Flow (Sudo)     |
| Recent login history                                          | `last`                                                                                                            | Native        | Only expected user login entries. No odd or high-frequency logins from unknown accounts.                                                                  | T1087 Account Discovery                    |
| Failed login attempts                                          | `lastb`                                                                                                           | Native        | Only known user failures. No brute-force spikes or unknown usernames.                                                                                      | T1087 Account Discovery                    |
| Symlinked or missing history files                             | `find / -name '.*history' 2>/dev/null \| grep null`                                                                 | Native        | **No output.** (History files should be intact; not symlinked to `/dev/null` except if explicitly hardened.)                                                  | T1087 Account Discovery                    |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **6. System Logs & Audit Trails**                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Binary data injected into logs                                  | `grep '[[:cntrl:]]' /var/log/*.log 2>/dev/null`                                                                     | Native        | **No output.** (No embedded control characters in plain-text logs.)                                                                                         | T1005 Data from Local System               |
| Auditd `execve` events                                           | `ausearch -m execve -ts today 2>/dev/null`                                                                         | Native        | Only expected exec calls (e.g., `/usr/bin/sshd`, `/usr/bin/systemd`). No unexpected binaries invoked.                                                     | T1005 Data from Local System               |
| Inspect systemd journal around incident                            | `journalctl -S yesterday -U now 2>/dev/null`                                                                        | Native        | Continuous, coherent logs. No large gaps, abrupt gaps, or missing entries.                                                                                | T1005 Data from Local System               |
| Log rotation / Missing log files                                   | `ls -al /var/log/*.1 /var/log/*.gz 2>/dev/null`                                                                     | Native        | Old rotated logs exist and sizes look reasonable. No zero-byte (empty) rotated logs unless legitimately archived.                                          | T1005 Data from Local System               |
| Suspicious cron entries                                            | `ls /etc/cron* /var/spool/cron/crontabs 2>/dev/null`                                                                 | Native        | Only known cronjobs. No scripts launching from `/tmp` or unknown executables.                                                                              | T1053 Scheduled Task                      |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **7. Live Memory & Disk Forensics**                           |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Dump full RAM (AVML example)                                      | `avml /tmp/mem.dmp`                                                                                                | External      | File `/tmp/mem.dmp` containing a complete RAM image. (Use Volatility to inspect.)                                                                          | T1055 Process Injection                   |
| Dump full RAM (LiME example)                                       | <pre>`insmod lime.ko "path=/tmp/mem.lime format=lime"`</pre>                                                         | External      | File `/tmp/mem.lime` created without errors.                                                                                                              | T1055 Process Injection                   |
| Process memory snapshot                                            | <pre>`export PID=<target>`  <br>`kill -STOP $PID`  <br>`gcore $PID`</pre>                                           | Native        | A core dump named `$PID.core` appears in CWD. (After analysis, `kill -CONT $PID` to resume.)                                                                 | T1055 Process Injection                   |
| Create disk image locally                                          | `dd if=/dev/sdX bs=4M of=/tmp/disk_image.dd && gzip /tmp/disk_image.dd`                                            | Native        | A gzipped image `/tmp/disk_image.dd.gz`—no I/O errors.                                                                                                     | T1005 Data from Local System               |
| Carve filesystem timeline                                          | <pre>`mmls <IMAGE>`  <br>`fls -o <OFFSET> -r -m / <IMAGE> \> fls.txt`  <br>`mactime -b fls.txt \> timeline.csv`</pre> | External      | `timeline.csv` showing file MAC-times (Modified, Accessed, Changed) sorted by time.                                                                        | T1005 Data from Local System               |
| List partition layout                                                | `mmls /tmp/disk_image.dd.gz`                                                                                      | External      | A listing of partition offsets/types.                                                                                                                      | T1005 Data from Local System               |
| List deleted/unallocated blocks                                      | `blkls /tmp/disk_image.dd.gz \> unallocated.blkls`                                                                 | External      | `unallocated.blkls` contains raw data from unallocated filesystem blocks (for carving).                                                                    | T1005 Data from Local System               |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **8. CLI & DFIR Tools**                                        |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Check for known rootkits (`chkrootkit`)                              | `chkrootkit`                                                                                                       | External      | No “INFECTED” or “Vulnerable” messages—only “Checking ... OK.”                                                                                            | T1215 Kernel Modules and Extensions       |
| Check for known rootkits (`rkhunter`)                                | `rkhunter --check --sk`                                                                                           | External      | No warnings or “Warning: Rootkit found” entries. All tests pass.                                                                                          | T1215 Kernel Modules and Extensions       |
| Scan for hidden processes (`unhide`)                                  | `unhide quick`                                                                                                     | External      | Only legitimate PIDs listed (matching `ps`). No extra hidden PIDs.                                                                                        | T1057 Process Discovery                   |
| Static ELF inspection (`readelf` / `strings`)                         | <pre>`readelf -h /usr/bin/sshd`  <br>`strings /usr/bin/sshd`</pre>                                                 | Native        | Correct ELF header for target architecture. No suspicious high-entropy or unusual embedded strings.                                                         | T1036 Masquerading                       |
| YARA scanning for known patterns (`yara`)                             | `yara -r /usr/local/share/yara_rules -s /usr/bin/ssh`                                                              | External      | **No matches.** (If a malware rule matches, output is produced.)                                                                                          | T1215 Kernel Modules and Extensions       |
| Strace on suspicious process                                          | `strace -f -e execve -p <PID> 2>&1`                                                                                  | Native        | Shows only expected exec calls. No child processes spawning from unexpected binaries.                                                                      | T1055 Process Injection                   |
| List active BPF programs                                              | `bpftool prog list 2>/dev/null`                                                                                     | Native        | Only legitimate BPF programs (e.g., CNI, performance tracing). No unknown or kernel-hijacking BPF hooks.                                                  | T1215 Kernel Modules and Extensions       |
| List active BPF maps                                                  | `bpftool map list 2>/dev/null`                                                                                      | Native        | Only maps belonging to known programs.                                                                                                                     | T1215 Kernel Modules and Extensions       |
| Audit kernel syscall hooks via BPF                                     | `tracee-ebpf --list`                                                                                                | External      | Only expected events (e.g., `sys_enter_execve`, `sys_exit_read`). No “hooked_proc_fops” or “hidden_kernel_module” flagged.                                 | T1215 Kernel Modules and Extensions       |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **9. Container & VM Indicators**                                 |                                                                                                                 |               |                                                                                                                                                         |                                          |
| List running Docker containers                                        | `docker ps --format '{{.ID}}\t{{.Image}}\t{{.Names}}\t{{.Status}}'`                                                 | External      | Only approved containers (e.g., `nginx:latest`). No unknown privileged (`--privileged`) containers.                                                         | T1536 Provision Container                  |
| Check Docker container mounts                                         | `jq '.Mounts' /var/lib/docker/containers/<ID>/config.v2.json`                                                      | External      | Only expected volume binds. No host root or sensitive mounts.                                                                                              | T1536 Provision Container                  |
| Inspect KVM/QEMU VM logs                                              | `ls /var/log/libvirt/qemu`                                                                                           | Native        | Only VMs created by the virtualization team. No unexplained new domain logs (e.g., VM with random name).                                                    | T1562.003 Impair Defenses                  |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **10. Persistence & Backdoor Evidence**                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Inspect `/etc/rc.local` for startup scripts                             | `cat /etc/rc.local 2>/dev/null`                                                                                       | Native        | Only documented startup steps. No calls to unknown binaries in `/tmp` or suspicious paths.                                                                 | T1547 Boot or Logon Autostart Execution    |
| List scripts in init directories                                         | `ls /etc/init.d/ /etc/rc*.d/ 2>/dev/null`                                                                              | Native        | Only expected service scripts (e.g., `ssh`, `network`). No random “.sh” under `/etc/rc2.d/` referring to unknown executables.                            | T1547 Boot or Logon Autostart Execution    |
| List systemd unit files and statuses                                     | `systemctl list-unit-files --type=service --state=enabled`                                                            | Native        | Only approved services (e.g., `ssh.service`, `cron.service`). No user-created malicious units.                                                               | T1547 Boot or Logon Autostart Execution    |
| Check SSH persistence in root’s home                                       | `ls /root/.ssh/authorized_keys 2>/dev/null`                                                                             | Native        | Only administrator’s public keys. No extra keys belonging to unknown users.                                                                                 | T1574.002 Hijack Execution Flow (SSH)      |
| Check for hidden cron entries                                              | `grep -R '.' /var/spool/cron/crontabs 2>/dev/null`                                                                     | Native        | Only known user cronjobs. No entries launching scripts from `/tmp` or `/dev/shm`.                                                                          | T1053 Scheduled Task                      |
|                                                            |                                                                                                                 |               |                                                                                                                                                         |                                          |
| **11. Indicator & Timeline Correlation**                          |                                                                                                                 |               |                                                                                                                                                         |                                          |
| Uptime & unexpected reboots                                              | `uptime`                                                                                                             | Native        | Shows system uptime consistent with maintenance windows. No recent, unexpected reboots.                                                                    | T1050 New Service                           |
| Build file activity timeline                                             | <pre>`fls -r -m / <IMAGE> \| mactime -b -`</pre>                                                                       | External      | A CSV where file modification/access times align with known maintenance. No bursts of creation/deletion outside approved windows.                         | T1005 Data from Local System               |
| Correlate user logins with suspicious times                               | `last -s -7days`                                                                                                     | Native        | Only legitimate user logins at expected hours. No logins from root or unknown users at unusual times.                                                      | T1087 Account Discovery                    |
| Check for gaps in logs                                                    | `journalctl --verify 2>/dev/null`                                                                                        | Native        | Output “OK” if no corruption. No missing journal entries or verification errors.                                                                             | T1005 Data from Local System               |